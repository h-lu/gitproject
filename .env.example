# ============================================================
# Gitea 自动评分系统配置文件
# ============================================================
# 使用说明：
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 根据实际情况修改下面的配置项
# 3. 确保 .env 文件不被提交到 Git (已在 .gitignore 中)
# ============================================================
#
# 📌 重要提示：
# 本系统已重构为多课程/多作业模式。
# 课程和作业的具体配置通过 YAML 文件管理：
#   - courses/{course_id}/course_config.yaml       # 课程配置（组织名、管理员等）
#   - courses/{course_id}/assignments/{id}/config.yaml  # 作业配置（截止时间、语言等）
#
# 此 .env 文件仅配置系统级的全局设置。
# ============================================================

# ============================================================
# 1. Docker 服务配置
# ============================================================

# PostgreSQL 数据库密码
POSTGRES_PASSWORD=your_strong_password_here

# Gitea 服务器配置（外部访问地址）
# 注意：这个地址需要从外部可访问（如果在服务器上部署，应该是服务器的公网 IP 或域名）
GITEA_DOMAIN=192.168.1.100
GITEA_ROOT_URL=http://192.168.1.100:3000/
GITEA_URL=http://192.168.1.100:3000

# 外部 Gitea 主机（用于 Workflow 中访问 Gitea）
# 通常与 GITEA_DOMAIN 相同，但不包含 http://
EXTERNAL_GITEA_HOST=192.168.1.100:3000

# ============================================================
# 2. Gitea Admin Token（脚本使用）
# ============================================================

# 管理员访问 Token
# 权限要求: write:admin, write:organization, write:repository, read:user
# 生成位置: Gitea → 用户设置 → 应用 → 管理访问令牌
# 用途: 管理脚本使用此 Token 创建组织、仓库、用户等
GITEA_ADMIN_TOKEN=your_admin_token_here

# ============================================================
# 3. Gitea Actions Runner 配置
# ============================================================

# Runner 注册令牌（从 Gitea 管理面板获取）
# 获取位置: Gitea → 站点管理 → Actions → Runners
RUNNER_REGISTRATION_TOKEN=your_runner_registration_token_here

# Runner 访问私有测试仓库的凭据
# 用途: Workflow 在运行时克隆私有的 tests 仓库
# 权限要求: read:repository
RUNNER_TESTS_USERNAME=your_tests_username
RUNNER_TESTS_TOKEN=your_tests_token

# 可选：元数据仓库配置（用于自动上传成绩）
# 推荐配置：一门课程使用一个元数据仓库，所有作业的成绩会自动存储在对应的子目录中
# 例如：CS101-2025Fall/course-metadata 仓库中会有 hw1/, hw2/, hw3/ 等子目录
# 权限要求: write:repository
# RUNNER_METADATA_REPO=CS101-2025Fall/course-metadata
# RUNNER_METADATA_TOKEN=your_metadata_upload_token
# RUNNER_METADATA_BRANCH=main

# ============================================================
# 4. LLM 评分配置（可选）
# ============================================================
# 如果您的作业使用 LLM 评分简答题，需要配置以下变量

# LLM API 配置（以 DeepSeek 为例）
# LLM_API_KEY=your_deepseek_api_key_here
# LLM_API_URL=https://api.deepseek.com/v1/chat/completions
# LLM_MODEL=deepseek-chat

# ============================================================
# 5. 镜像源配置（可选，中国大陆加速）
# ============================================================

# PyPI 镜像源（Python 包）
PIP_INDEX_URL=https://pypi.tuna.tsinghua.edu.cn/simple

# CRAN 镜像源（R 包）
CRAN_MIRROR=https://mirrors.tuna.tsinghua.edu.cn/CRAN/

# Maven 镜像源（Java 包）
MAVEN_MIRROR_URL=https://maven.aliyun.com/repository/public

# ============================================================
# 6. Docker 容器配置（可选）
# ============================================================

# Python 容器版本
PYTHON_CONTAINER=python:3.11

# Java 容器版本
JAVA_CONTAINER=maven:3.9-eclipse-temurin-17
GRADLE_CONTAINER=gradle:8.5-jdk17

# R 容器版本
R_CONTAINER=r-base:4.3

# Workflow 超时时间（分钟）
WORKFLOW_TIMEOUT=15

# ============================================================
# 配置检查清单
# ============================================================
# 必需配置（必须修改）：
#   [x] POSTGRES_PASSWORD - 数据库密码
#   [x] GITEA_DOMAIN / GITEA_ROOT_URL / GITEA_URL - Gitea 地址
#   [x] EXTERNAL_GITEA_HOST - Gitea 主机地址
#   [x] GITEA_ADMIN_TOKEN - 管理员 Token
#   [x] RUNNER_REGISTRATION_TOKEN - Runner 注册令牌
#   [x] RUNNER_TESTS_USERNAME - 测试用户名
#   [x] RUNNER_TESTS_TOKEN - 测试 Token
#
# 可选配置（根据需要启用）：
#   [ ] DEEPSEEK_API_KEY - 如果使用 LLM 评分
#   [ ] PIP_INDEX_URL - 如果在中国大陆需要加速
#   [ ] 其他镜像源和容器配置
# ============================================================
