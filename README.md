# ğŸ¤– Gitea Automated Grading System

åŸºäº Gitea Actions çš„å¤šè¯¾ç¨‹è‡ªåŠ¨è¯„åˆ†ç³»ç»Ÿï¼Œæ”¯æŒ Pythonã€Javaã€R å’Œ LLM è¯„åˆ†ã€‚

> **ğŸ“Œ é‡è¦æç¤º**: æœ¬ç³»ç»Ÿå·²é‡æ„ä¸ºå¤šè¯¾ç¨‹/å¤šä½œä¸šæ¨¡å¼ã€‚è¯„åˆ†è„šæœ¬å·²é›†ä¸­åŒ–åˆ° `scripts/autograde/`ï¼Œæ‰€æœ‰è¯¾ç¨‹å…±äº«ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ“ **å¤šè¯¾ç¨‹æ”¯æŒ**: æ¯ä¸ªè¯¾ç¨‹ç‹¬ç«‹ç®¡ç†ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„ Gitea ç»„ç»‡
- ğŸ“ **å¤šä½œä¸šç®¡ç†**: æ¯ä¸ªè¯¾ç¨‹å¯ä»¥æœ‰å¤šä¸ªä½œä¸šï¼Œé…ç½®ç‹¬ç«‹
- ğŸ¤– **è‡ªåŠ¨è¯„åˆ†**: åŸºäº Gitea Actions çš„ CI/CD è¯„åˆ†æµæ°´çº¿
- ğŸ§ª **å¤šè¯­è¨€æ”¯æŒ**: Python (3.11)ã€Java (JDK 21)ã€R (4.3.1)
- ğŸ’¬ **LLM è¯„åˆ†**: æ”¯æŒä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹è¯„åˆ†ç®€ç­”é¢˜
- ğŸ“Š **æˆç»©æ”¶é›†**: è‡ªåŠ¨æ”¶é›†æ‰€æœ‰å­¦ç”Ÿæˆç»©åˆ° CSV
- ğŸ”„ **é›†ä¸­åŒ–ç®¡ç†**: è¯„åˆ†è„šæœ¬å’Œ workflow æ¨¡æ¿ç»Ÿä¸€ç®¡ç†
- ğŸ‡¨ğŸ‡³ **CN é•œåƒåŠ é€Ÿ**: ä½¿ç”¨è…¾è®¯äº‘ã€æ¸…åã€é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿä¾èµ–å®‰è£…

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
gitproject/
â”œâ”€â”€ scripts/                    # ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ autograde/             # ğŸ†• é›†ä¸­åŒ–çš„è¯„åˆ†è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ grade.py           # ç¼–ç¨‹é¢˜è¯„åˆ†
â”‚   â”‚   â”œâ”€â”€ llm_grade.py       # LLM ç®€ç­”é¢˜è¯„åˆ†
â”‚   â”‚   â”œâ”€â”€ objective_grade.py # å®¢è§‚é¢˜è¯„åˆ†
â”‚   â”‚   â”œâ”€â”€ upload_metadata.py # æˆç»©ä¸Šä¼ 
â”‚   â”‚   â””â”€â”€ workflow_templates/# Workflow æ¨¡æ¿ (python, java, r)
â”‚   â”œâ”€â”€ generate_repos.py      # ç”Ÿæˆå­¦ç”Ÿ

ä»“åº“
â”‚   â”œâ”€â”€ sync_autograde.py      # ğŸ†• åŒæ­¥è¯„åˆ†è„šæœ¬åˆ°ä½œä¸š
â”‚   â”œâ”€â”€ collect_grades.py      # æ”¶é›†æˆç»©
â”‚   â””â”€â”€ quick_collect.sh       # å¿«é€Ÿæ”¶é›†è„šæœ¬
â”œâ”€â”€ courses/                   # è¯¾ç¨‹ç›®å½•
â”‚   â””â”€â”€ CS101/                # ç¤ºä¾‹è¯¾ç¨‹
â”‚       â”œâ”€â”€ course_config.yaml # è¯¾ç¨‹é…ç½®
â”‚       â”œâ”€â”€ students.txt       # å­¦ç”Ÿåˆ—è¡¨
â”‚       â””â”€â”€ assignments/       # ä½œä¸šç›®å½•
â”‚           â”œâ”€â”€ hw_python/    # Python ä½œä¸šç¤ºä¾‹
â”‚           â”œâ”€â”€ hw_java/      # Java ä½œä¸šç¤ºä¾‹
â”‚           â””â”€â”€ hw_r/         # R ä½œä¸šç¤ºä¾‹
â””â”€â”€ docs/                     # æ–‡æ¡£
```

## ğŸ“š æ–‡æ¡£

å®Œæ•´æ–‡æ¡£ä½äº `docs/` ç›®å½•ï¼š

- ğŸ“– **[å¿«é€Ÿå¼€å§‹](docs/GETTING_STARTED.md)**: ç³»ç»Ÿé…ç½®å’Œè¿è¡Œç¬¬ä¸€ä¸ªè¯¾ç¨‹
- ğŸ“ **[æ•™å¸ˆæŒ‡å—](docs/INSTRUCTOR_GUIDE.md)**: ç®¡ç†è¯¾ç¨‹å’Œä½œä¸š
- ğŸ‘¨â€ğŸ’» **[å¼€å‘è€…æŒ‡å—](docs/DEVELOPER_GUIDE.md)**: ç³»ç»Ÿæ¶æ„å’Œæ•…éšœæ’é™¤
- ğŸ‘¨â€ğŸ“ **[å­¦ç”ŸæŒ‡å—](docs/STUDENT_GUIDE.md)**: å­¦ç”Ÿæäº¤ä½œä¸šæµç¨‹
- ğŸ› ï¸  **[è„šæœ¬æ–‡æ¡£](scripts/README.md)**: æ‰€æœ‰ç®¡ç†è„šæœ¬çš„è¯¦ç»†è¯´æ˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡

```bash
docker-compose up -d
```

### 2. é…ç½®ç¯å¢ƒ

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env è®¾ç½®å¿…è¦çš„å˜é‡
# - GITEA_ADMIN_TOKEN: Gitea ç®¡ç†å‘˜ Token
# - RUNNER_TESTS_TOKEN: Runner è®¿é—®ç§æœ‰æµ‹è¯•çš„ Token
# - RUNNER_METADATA_TOKEN: ä¸Šä¼ æˆç»©å…ƒæ•°æ®çš„ Token
nano .env

# åŒæ­¥ Runner é…ç½®
./scripts/sync_runner_config.sh
docker-compose restart runner
```

### 3. åˆ›å»ºè¯¾ç¨‹å’Œä½œä¸š

```bash
# æŸ¥çœ‹ç¤ºä¾‹è¯¾ç¨‹
ls courses/CS101/

# ä½œä¸šç»“æ„
courses/CS101/assignments/hw_python/
â”œâ”€â”€ config.yaml       # ä½œä¸šé…ç½®
â”œâ”€â”€ template/         # å­¦ç”Ÿä»“åº“æ¨¡æ¿
â”‚   â”œâ”€â”€ src/         # æºä»£ç 
â”‚   â”œâ”€â”€ .gitea/workflows/  # CI/CD workflows
â”‚   â””â”€â”€ README.md
â””â”€â”€ tests/           # ç§æœ‰æµ‹è¯•ï¼ˆæ¨é€åˆ° Giteaï¼‰
    â”œâ”€â”€ python/tests/    # ç¼–ç¨‹æµ‹è¯•
    â”œâ”€â”€ llm/rubric.json  # LLM è¯„åˆ†æ ‡å‡†
    â””â”€â”€ objective/       # å®¢è§‚é¢˜ç­”æ¡ˆ
```

### 4. ç”Ÿæˆå­¦ç”Ÿä»“åº“

```bash
# Python ä½œä¸š
python3 scripts/generate_repos.py \
  --course courses/CS101 \
  --assignment hw_python

# Java ä½œä¸š
python3 scripts/generate_repos.py \
  --course courses/CS101 \
  --assignment hw_java

# R ä½œä¸š
python3 scripts/generate_repos.py \
  --course courses/CS101 \
  --assignment hw_r
```

### 5. æ”¶é›†æˆç»©

```bash
# ä½¿ç”¨å¿«é€Ÿæ”¶é›†è„šæœ¬
./scripts/quick_collect.sh -c courses/CS101 -a hw_python

# æˆ–ä½¿ç”¨ Python è„šæœ¬
python3 scripts/collect_grades.py \
  --course courses/CS101 \
  --assignment hw_python \
  --output grades.csv
```

## ğŸ”§ æ ¸å¿ƒå·¥ä½œæµ

### è¯„åˆ†è„šæœ¬åŒæ­¥

è¯„åˆ†è„šæœ¬ç°åœ¨é›†ä¸­åœ¨ `scripts/autograde/`ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åŒæ­¥åˆ°æ‰€æœ‰ä½œä¸šï¼š

```bash
# åŒæ­¥åˆ°æ‰€æœ‰è¯¾ç¨‹çš„æ‰€æœ‰ä½œä¸š
python3 scripts/sync_autograde.py

# ä»…åŒæ­¥æŒ‡å®šè¯¾ç¨‹
python3 scripts/sync_autograde.py --course courses/CS101
```

### è‡ªåŠ¨è¯„åˆ†æµç¨‹

1. **å­¦ç”Ÿæäº¤**: Push ä»£ç åˆ° `main` åˆ†æ”¯
2. **è§¦å‘ CI/CD**: Gitea Actions è‡ªåŠ¨è¿è¡Œ
3. **è¿è¡Œæµ‹è¯•**: 
   - ç¼–ç¨‹é¢˜: pytest/JUnit/testthat
   - ç®€ç­”é¢˜: LLM è¯„åˆ†
   - å®¢è§‚é¢˜: JSON æ¯”å¯¹
4. **ç”Ÿæˆæˆç»©**: åˆ›å»º `grade.json` å’Œ `metadata.json`
5. **ä¸Šä¼ å…ƒæ•°æ®**: æ¨é€åˆ° `course-metadata` ä»“åº“
6. **æ”¶é›†æˆç»©**: æ•™å¸ˆè¿è¡Œæ”¶é›†è„šæœ¬è·å– CSV

## ğŸ’¡ ä¸»è¦æ”¹è¿›

### v2.0 æ›´æ–° (æœ€æ–°)

- âœ… **é›†ä¸­åŒ–è¯„åˆ†è„šæœ¬**: `scripts/autograde/` ç»Ÿä¸€ç®¡ç†
- âœ… **è‡ªåŠ¨è„šæœ¬åŒæ­¥**: `sync_autograde.py` è‡ªåŠ¨åˆ†å‘åˆ°ä½œä¸š
- âœ… **ç”Ÿæˆæ—¶è‡ªåŠ¨å¤åˆ¶**: åˆ›å»ºæ–°ä½œä¸šæ—¶è‡ªåŠ¨åŒ…å«è¯„åˆ†è„šæœ¬
- âœ… **Workflow æ¨¡æ¿**: æ ‡å‡†åŒ–çš„ Python/Java/R workflow
- âœ… **CN é•œåƒåŠ é€Ÿ**: è…¾è®¯äº‘ apt/PyPIã€æ¸…å CRANã€é˜¿é‡Œäº‘ Maven
- âœ… **åŠ¨æ€å‚æ•°æ¨æ–­**: è‡ªåŠ¨ä»ä»“åº“åæ¨æ–­ assignment_id
- âœ… **å…ƒæ•°æ®æ›´æ–°æ”¯æŒ**: upload_metadata.py æ”¯æŒ PUT æ›´æ–°

## ğŸ¯ æ”¯æŒçš„è¯­è¨€

| è¯­è¨€ | ç‰ˆæœ¬ | æµ‹è¯•æ¡†æ¶ | ä¾èµ–é•œåƒ |
|------|------|----------|----------|
| **Python** | 3.11 | pytest | è…¾è®¯äº‘ PyPI |
| **Java** | JDK 21 + Gradle 9.0 | JUnit 5 | é˜¿é‡Œäº‘ Maven |
| **R** | 4.3.1 | testthat | æ¸…å CRAN |

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License


## ğŸ“ é¡¹ç›®ç»“æ„

```
GitProject/
â”œâ”€â”€ courses/                    # è¯¾ç¨‹ç›®å½•
â”‚   â””â”€â”€ CS101/                 # è¯¾ç¨‹ ID
â”‚       â”œâ”€â”€ course_config.yaml # è¯¾ç¨‹é…ç½®
â”‚       â”œâ”€â”€ students.txt       # å­¦ç”Ÿåå•
â”‚       â””â”€â”€ assignments/       # ä½œä¸šç›®å½•
â”‚           â””â”€â”€ hw1/           # ä½œä¸š ID
â”‚               â”œâ”€â”€ config.yaml    # ä½œä¸šé…ç½®
â”‚               â”œâ”€â”€ template/      # å­¦ç”Ÿèµ·å§‹ä»£ç 
â”‚               â””â”€â”€ tests/         # ç§æœ‰æµ‹è¯•
â”œâ”€â”€ scripts/                   # ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ generate_repos.py     # ç”Ÿæˆå­¦ç”Ÿä»“åº“
â”‚   â”œâ”€â”€ collect_grades.py     # æ”¶é›†æˆç»©
â”‚   â”œâ”€â”€ create_users.py       # æ‰¹é‡åˆ›å»ºç”¨æˆ·
â”‚   â”œâ”€â”€ delete_repos.py       # åˆ é™¤ä»“åº“
â”‚   â”œâ”€â”€ sync_runner_config.sh # åŒæ­¥ .env åˆ° Runner é…ç½®
â”‚   â””â”€â”€ ...                   # å…¶ä»–å·¥å…·è„šæœ¬
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”œâ”€â”€ docker-compose.yml         # Docker é…ç½®
â””â”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

## ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µ

### å¤šè¯¾ç¨‹æ¶æ„

- **è¯¾ç¨‹ (Course)**: æ¯ä¸ªè¯¾ç¨‹æœ‰ç‹¬ç«‹çš„ Gitea ç»„ç»‡ï¼ˆå¦‚ `CS101-2025Fall`ï¼‰
- **ä½œä¸š (Assignment)**: æ¯ä¸ªä½œä¸šæœ‰ç‹¬ç«‹çš„æ¨¡æ¿ä»“åº“ã€æµ‹è¯•ä»“åº“å’Œå­¦ç”Ÿä»“åº“
- **é…ç½®æ–‡ä»¶**: ä½¿ç”¨ YAML æ–‡ä»¶ç®¡ç†è¯¾ç¨‹å’Œä½œä¸šå…ƒæ•°æ®
- **è‡ªåŠ¨å‘½å**: ä»“åº“åè‡ªåŠ¨æ ¹æ®ä½œä¸š ID ç”Ÿæˆï¼ˆå¦‚ `hw1-template`, `hw1-tests`, `hw1-stu_student1`ï¼‰

### å·¥ä½œæµç¨‹

1. **æ•™å¸ˆ**: åˆ›å»ºè¯¾ç¨‹å’Œä½œä¸šé…ç½® â†’ è¿è¡Œç”Ÿæˆè„šæœ¬ â†’ å­¦ç”Ÿä»“åº“è‡ªåŠ¨åˆ›å»º
2. **å­¦ç”Ÿ**: å…‹éš†ä»“åº“ â†’ å®Œæˆä½œä¸š â†’ æ¨é€ä»£ç  â†’ è‡ªåŠ¨è¯„åˆ†
3. **æ•™å¸ˆ**: è¿è¡Œæ”¶é›†è„šæœ¬ â†’ è·å–æ‰€æœ‰å­¦ç”Ÿæˆç»©

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Gitea**: Git ä»“åº“æ‰˜ç®¡å’Œ Gitea Actions CI/CD
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²
- **Python**: ç®¡ç†è„šæœ¬å’Œè¯„åˆ†é€»è¾‘
- **PostgreSQL**: Gitea æ•°æ®åº“

## ğŸ“– æ›´å¤šä¿¡æ¯

- [æ•™å¸ˆæŒ‡å—](docs/INSTRUCTOR_GUIDE.md) - å¦‚ä½•ç®¡ç†è¯¾ç¨‹å’Œä½œä¸š
- [å­¦ç”ŸæŒ‡å—](docs/STUDENT_GUIDE.md) - å¦‚ä½•æäº¤ä½œä¸š
- [å¼€å‘è€…æŒ‡å—](docs/DEVELOPER_GUIDE.md) - ç³»ç»Ÿæ¶æ„å’Œæ•…éšœæ’é™¤
- [è„šæœ¬æ–‡æ¡£](scripts/README.md) - æ‰€æœ‰è„šæœ¬çš„è¯¦ç»†ä½¿ç”¨è¯´æ˜

## ğŸ“„ License

MIT License
